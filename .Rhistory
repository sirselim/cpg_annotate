nihs2010 <- read.csv('/media/miles/Backup/miles_lappy/Data/Phd/UUID_Miles/NIHS2010_phenodata.csv', head = T)
nihs2000 <- read.csv('/media/miles/Backup/miles_lappy/Data/Phd/UUID_Miles/NIHS2000_phenodata.csv', head = T)
uuid <- read.csv('/media/miles/Data/Phd/UUID_Miles/NI_UUID_Ped_120531.csv', head = T)
uuid <- read.csv('/media/miles/Data/Phd/UUID_Miles/NI_UUID_Ped_120531.csv', head = T)
uuid <- read.csv('/media/miles/Backup/miles_lappy/Data/Phd/UUID_Miles/NI_UUID_Ped_120531.csv', head = T)
NIES.pheno <- read.csv('/media/miles/Backup/miles_lappy/Data/Phd/NIES_GWAS/NIES_master_database_110503.csv', head = T)
glu_geno <- read.csv('Glu_geno.csv', head = T)
head(glu_geno)
head(NIES.pheno)
table(NIES.pheno$UUID %in% glu_geno$UUID)
table(NIES.pheno$UUID %in% glu_geno$UUID & glu_geno$simple == 1)
table(nihs2000$UUID %in% glu_geno$UUID)
table(nihs2010$UUID %in% glu_geno$UUID)
nies.weight <- NIES.pheno[c('UUID', 'Current.weight')]
nihs2000.weight <- nihs2000[c('UUID', 'WEIGHT')]
nihs2010.weight <- nihs2010[c('UUID', 'WEIGHT')]
head(nihs2000.weight)
head(nihs2010.weight)
colnames(nies.weight)[2]
colnames(nies.weight)[2] <- 'WEIGHT'
merge(nies.weight, nihs2000.weight, by = c('UUID', 'WEIGHT'))
merge(nies.weight, nihs2000.weight, by = c('UUID', 'WEIGHT'), all = T)
test <- merge(nies.weight, nihs2000.weight, by = c('UUID', 'WEIGHT'), all = T)
test2 <- merge(test, nihs2010.weight, by = c('UUID', 'WEIGHT'), all = T)
test2
test3 <- na.omit(test2)
test3
table(glu_geno$UUID $in$ test3$UUID)
table(glu_geno$UUID %in% test3$UUID)
merge(glu_geno, test3, by = 'UUID')
test4 <- merge(glu_geno, test3, by = 'UUID')
boxplot(test4$WEIGHT ~ test4$simple)
table(test4$simple)
nihs2000.weight <- nihs2000[c('UUID', 'WEIGHT', 'LDL')]
nihs2010.weight <- nihs2010[c('UUID', 'WEIGHT', 'LDL')]
head(nihs2010.weight)
nihs2000.weight <- nihs2000[c('UUID', 'WEIGHT', 'LDL', 'HDL')]
nihs2010.weight <- nihs2010[c('UUID', 'WEIGHT', 'LDL', 'HDL')]
head(nihs2010)
nihs2010.weight <- nihs2010[c('UUID', 'WEIGHT', 'LDL', 'HDL.CHOLESTEROL')]
colnames(nihs2010.weight)[4]
colnames(nihs2010.weight)[4] <- 'HDL'
test2 <- merge(nihs2000.weight, nihs2010.weight, by = c('UUID', 'WEIGHT', 'LDL', 'HDL'), all = T)
test3 <- na.omit(test2)
test3
test4 <- merge(glu_geno, test3, by = 'UUID')
boxplot(test4$HDL ~ test4$simple)
boxplot(test4$LDL ~ test4$simple)
test4
test4 <- merge(glu_geno, test3, by = 'UUID', all = T)
test4
test4 <- test4[na.omit(test4$simple),]
test4 <- test4[na.omit(test4$simple)]
test4 <- merge(glu_geno, test3, by = 'UUID', all = T)
test4 <- test4[na.omit(test4$simple)]
test4
test4 <- merge(glu_geno, test3, by = 'UUID', all = T)
test4 <- test4[!is.na(test4$simple),]
test4
table(test4$simple)
boxplot(test4$LDL ~ test4$simple)
boxplot(test4$LDL ~ test4$simple)
boxplot(test4$HDL ~ test4$simple)
t.test(test4$HDL, test4$simple)
t.test(test4$HDL ~ test4$simple)
t.test(test4$LDL ~ test4$simple)
boxplot(test4$LDL ~ test4$simple)
t.test(test4[test4$simple == 1,]$LDL ~ test4[test4$simple == 0,]$LDL)
t.test(test4[test4$simple == 1,]$LDL, test4[test4$simple == 0,]$LDL)
t.test(test4$LDL, test4$simple)
t.test(test4$WEIGHT, test4$simple)
boxplot(test4$HDL ~ test4$WEIGHT)
boxplot(test4$WEIGHT ~ test4$simple)
t.test(test4$WEIGHT, test4$simple)
t.test(test4$LDL, test4$simple)
t.test(test4$WEIGHT ~ test4$simple)
t.test(test4$LDL ~ test4$simple)
t.test(test4$HDL ~ test4$simple)
t.test(test4$WEIGHT ~ test4$simple)
head(nihs2000)
head(nihs2010)
nihs2000.weight <- nihs2000[c('UUID', 'WEIGHT', 'LDL', 'HDL', 'T2D_risk')]
nihs2010.weight <- nihs2010[c('UUID', 'WEIGHT', 'LDL', 'HDL.CHOLESTEROL', 'T2D_risk')]
colnames(nihs2010.weight)[4] <- 'HDL'
test2 <- merge(nihs2000.weight, nihs2010.weight, by = c('UUID', 'WEIGHT', 'LDL', 'HDL', 'T2D_risk'), all = T)
test3 <- na.omit(test2)
test4 <- merge(glu_geno, test3, by = 'UUID', all = T)
test4 <- test4[!is.na(test4$simple),]
boxplot(test4$T2D_risk ~ test4$simple)
t.test(test4$T2D_risk ~ test4$simple)
test4
duplicated(test4$UUID)
test4[!duplicated(test4$UUID)]
test4[!duplicated(test4$UUID),]
table(NIES.pheno$UUID %in% glu_geno$UUID)
nies.geno <- glu_geno[c('UUID', 'simple')]
merge(NIES.pheno, nies.geno, by = 'UUID')
test4 <- merge(NIES.pheno, nies.geno, by = 'UUID')
t.test(test4$Current.weight ~ test4$simple)
boxplot(test4$Current.weight ~ test4$simple)
boxplot(test4$Current.height ~ test4$simple)
table(test4$Gender, test4$simple)
t.test(test4$Current.height ~ test4$simple)
boxplot(test4$Miles_coreped ~ test4$simple)
boxplot(test4$Smoker ~ test4$simple)
boxplot(test4$Eye.Colour ~ test4$simple)
boxplot(test4$R.Cyl ~ test4$simple)
boxplot(test4$CDR.RE ~ test4$simple)
boxplot(test4$CDR.LE ~ test4$simple)
table(test4$simple)
boxplot(test4$CDR.RE ~ test4$simple)
boxplot(test4$CDR.LE ~ test4$simple)
t.test(test4$CDR.RE ~ test4$simple)
t.test(test4$CDR.LE ~ test4$simple)
ks.test(test4$CDR.LE ~ test4$simple)
ks.test(test4$CDR.LE, test4$simple)
ks.test()
?ks.test()
ks.test(test4[test4$simple == 1,]$CDR.LE, test4[test4$simple == 0,]$CDR.LE)
ks.test(test4[test4$simple == 1,]$Current.height, test4[test4$simple == 0,]$Current.height)
boxplot(test4$Pterygium ~ test4$simple)
boxplot(test4$Disc.size.RE ~ test4$simple)
test4$Disc.size.RE
table(test4$Disc.size.RE ~ test4$simple)
table(test4$Disc.size.RE, test4$simple)
table(test4$Disc.size.LE, test4$simple)
head(test4)
boxplot(test4$AC.Depth.R ~ test4$simple)
boxplot(test4$AC.Depth.L ~ test4$simple)
boxplot(test4$R.Pachimetry ~ test4$simple)
boxplot(test4$L.Pachimetry ~ test4$simple)
table(test4$Eye.Colour, test4$simple)
boxplot(test4$Current.height ~ test4$simple)
t.test(test4$Current.height ~ test4$simple)
library("biomaRt", lib.loc="/home/R/linux-library/main/site-library")
snpsMart = useMart("snp", dataset = "hsapiens_snp")
listMarts()
snpsMart = useMart("snp", dataset = "ENSEMBL_MART_SNP")
?useMart
snpsMart = useMart(biomart="ensembl", dataset = "ENSEMBL_MART_SNP")
mart <- useMart('snp')
mart <- useMart('ensembl')
listMarts()
listAttributes(mart)
mart
mart <- useMart(biomart="ensembl", dataset="hsapiens_gene_ensembl")
listAttributes(mart)
mart <- useMart(biomart="ensembl", dataset="hsapiens_snp_ensembl")
listDatasets()
mart <- useMart('ensembl')
listDatasets(mart)
listMarts()
mart <- useMart('ENSEMBL_MART_SNP')
listDatasets(mart)
mart <- useMart('ENSEMBL_MART_SNP', 'hsapiens_snp')
listAttributes(mart)
listAttributes(mart)
snps_attributes = c('refsnp_id', 'chr_name', 'chrom_start', 'minor_allele_freq')
snps_filters = c('snp_filter')
snps_values = c('rs185293715', 'rs61838549', 'rs28782254') # for example
snps_results = getBM(attributes = snps_attributes, filters = snps_filters, values = snps_values, mart = snpsMart)
snpsMart <- mart
snps_results = getBM(attributes = snps_attributes, filters = snps_filters, values = snps_values, mart = snpsMart)
snps_results
snps_values = c('rs185293715', 'rs61838549', 'rs28782254', 'rs1653299') # for example
snps_results = getBM(attributes = snps_attributes, filters = snps_filters, values = snps_values, mart = snpsMart)
snps_results
c('rs34508376', 'rs4474294','rs4595394','rs4590708','rs4925583','rs4478844','rs6658227','rs6697812','rs73141283','rs4244171',
'rs10888338','rs6667171','rs4916129','rs7555310','rs7555424','rs28545014','rs56721857','rs76878172','rs28698997','rs7417616','rs954475',
'rs28599722','rs9330305','rs2105243', 'rs201896684','rs61834268','rs77685347','rs1782241','rs55871516','rs41311583','rs4509608','rs13313088')
snps <- c('rs34508376', 'rs4474294','rs4595394','rs4590708','rs4925583','rs4478844','rs6658227','rs6697812','rs73141283','rs4244171',
'rs10888338','rs6667171','rs4916129','rs7555310','rs7555424','rs28545014','rs56721857','rs76878172','rs28698997','rs7417616','rs954475',
'rs28599722','rs9330305','rs2105243', 'rs201896684','rs61834268','rs77685347','rs1782241','rs55871516','rs41311583','rs4509608','rs13313088')
snps_results = getBM(attributes = snps_attributes, filters = snps_filters, values = snps, mart = snpsMart)
snps_results
unique(snps_results$refsnp_id)
snps <- c('rs9282861', 'rs1042028')
snps_results = getBM(attributes = snps_attributes, filters = snps_filters, values = snps, mart = snpsMart)
snps_results
setwd("/media/miles/Backup/miles_lappy/Media/methylation_data/longitudinal_NI")
meth.anno <- read.csv('../humanmethylation450_15017482_v1-2.csv', head = T, skip = 7, as.is = T)
meth.anno[grep('cg01854776', meth.anno$IlmnID),]
setwd("/media/disk1part1/manuscripts/cell_mixture/CpG marker panels/BayesMS/Reinius/betavalue")
hg38.anno <- read.delim('/media/disk1part1/genome_annotation/meth450K/illumina450k_annotation_cpgsnps_hg38_all_sorted.bed', head = F)
head(hg38.anno)
table(is.na(hg38.anno$V7))
ilmn450.anno <- readRDS(file = 'Ilmn450K_anno.RDS')
head(ilmn450.anno)
colnames(hg38.anno) <- c('CHR_hg38', 'start', 'end', 'strand', 'IlmnID', 'variant', 'SNP')
head(hg38.anno)
test <- merge(ilmn450.anno, hg38.anno, by 'IlmnID')
test <- merge(ilmn450.anno, hg38.anno, by = 'IlmnID')
test <- merge(ilmn450.anno, hg38.anno, by = 'IlmnID', sort = F)
head(test)
test$CHR <- paste0('chr', test$CHR)
head(test)
identical(test$CHR, test$CHR_hg38)
identical(test$CHR, test$CHR_hg38)
table(!(test$CHR, test$CHR_hg38))
tail(test)
ifelse(test$CHR == test$CHR_hg38, 1, 0)
test$filter <- ifelse(test$CHR == test$CHR_hg38, 1, 0)
test[test$filter == 0,]
head(ilmn450.anno)
# set chromosome order
chrOrder <- c(seq(1:22), 'X', 'Y', 'M')
test$CHR <- factor(test$CHR, levels=chrOrder)
head(test)
test <- merge(ilmn450.anno, hg38.anno, by = 'IlmnID', sort = F)
test$filter <- ifelse(test$CHR == test$CHR_hg38, 1, 0)
test$CHR <- factor(test$CHR, levels=chrOrder)
head(test)
test <- test[order(test$CHR),]
head(test)
tail(text)
tail(test)
test$CHR <- paste0('chr', test$CHR)
ifelse(test$CHR == test$CHR_hg38, 1, 0)
test$filter <- ifelse(test$CHR == test$CHR_hg38, 1, 0)
head(test)
tail(test)
table(test$filter)
colnames(test)
colnames(test)[c(7,8)]
colnames(test)[c(7,8)] <- c('start_38', 'end_hg38')
head(test)
ilmn450.anno <- test
saveRDS(ilmn450.anno, 'Ilmn450K_anno.RDS')
getwd()
setwd("/media/disk1part1/manuscripts/cell_mixture/CpG marker panels/BayesMS/Reinius/betavalue")
setwd("~/gitrepos/cpg_annotate")
saveRDS(ilmn450.anno, 'Ilmn450K_anno.RDS')
